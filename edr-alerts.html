<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>EDR Alerts — Interactive Module</title>

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Alpine.js CDN -->
  <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <style>
    /* small visual tweaks */
    .card { background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border: 1px solid rgba(255,255,255,0.04); }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", "Courier New", monospace; font-size: 0.9rem; }
    /* hide scrollbars for nicer iframes usage */
    .no-scrollbar::-webkit-scrollbar { display: none; } 
    .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    /* small process tree nodes */
    .node { cursor: pointer; transition: transform .12s ease; }
    .node:hover { transform: scale(1.04); }
  </style>
</head>
<body class="bg-[#0A0125] text-[#E5E7EB] antialiased">

<div class="max-w-6xl mx-auto p-6" x-data="edrModule()" x-init="init()">

  <!-- Header -->
  <header class="flex items-start justify-between gap-4 mb-6">
    <div>
      <h1 class="text-3xl font-bold text-[#8B5CF6]">Endpoint Detection & Response (EDR) Alerts</h1>
      <p class="text-sm text-gray-300 mt-1">Interactive micro-module for IT / SOC staff</p>
      <div class="mt-3 text-xs text-gray-400 max-w-prose">
        <strong>Learning objectives</strong>
        <ul class="ml-4 list-disc mt-1">
          <li>Understand the purpose of EDR systems</li>
          <li>Interpret telemetry to spot early compromise</li>
          <li>Separate benign events from true incidents</li>
          <li>Respond to EDR alerts to contain threats</li>
        </ul>
      </div>
    </div>

    <div class="text-right">
      <div class="text-sm text-gray-300">Progress</div>
      <div class="mt-1 flex gap-1">
        <template x-for="(s,i) in sections" :key="i">
          <div :title="s" class="w-12 h-3 rounded" :class="completed[s] ? 'bg-green-500' : 'bg-gray-700'"></div>
        </template>
      </div>
      <div class="mt-2 text-xs text-gray-400">Saved locally (browser)</div>
    </div>
  </header>

  <!-- Nav -->
  <nav class="mb-6 flex gap-2 flex-wrap">
    <button @click="go('intro')" :class="active==='intro' ? 'bg-[#8B5CF6]' : 'bg-gray-700'" class="px-4 py-2 rounded text-sm">Intro</button>
    <button @click="go('usecases')" :class="active==='usecases' ? 'bg-[#8B5CF6]' : 'bg-gray-700'" class="px-4 py-2 rounded text-sm">Use Cases</button>
    <button @click="go('telemetry')" :class="active==='telemetry' ? 'bg-[#8B5CF6]' : 'bg-gray-700'" class="px-4 py-2 rounded text-sm">Telemetry Lab</button>
    <button @click="go('process')" :class="active==='process' ? 'bg-[#8B5CF6]' : 'bg-gray-700'" class="px-4 py-2 rounded text-sm">Process Tree</button>
    <button @click="go('defense')" :class="active==='defense' ? 'bg-[#8B5CF6]' : 'bg-gray-700'" class="px-4 py-2 rounded text-sm">Defences</button>
    <button @click="go('takeaway')" :class="active==='takeaway' ? 'bg-[#8B5CF6]' : 'bg-gray-700'" class="px-4 py-2 rounded text-sm">Takeaway</button>
  </nav>

  <!-- Panels -->
  <section x-show="active==='intro'" x-cloak class="card p-6 rounded-lg">
    <div class="md:flex gap-6">
      <div class="flex-1">
        <h2 class="text-2xl font-semibold text-[#BCA6FF]">Introduction</h2>
        <p class="text-gray-300 mt-3">Endpoints (laptops, servers, workstations) are prime attack targets. EDR solutions provide continuous telemetry—process creation, command-line exec, network connections, and file modifications. Interpreting this telemetry helps SOC teams detect compromises early.</p>

        <ul class="list-disc ml-5 mt-4 text-sm text-gray-300">
          <li>Process creation & command-line monitoring</li>
          <li>Network connection tracking</li>
          <li>File mutations and persistence artifacts</li>
          <li>User behavior & unusual access patterns</li>
        </ul>

        <div class="mt-6 text-right">
          <button @click="complete('intro'); go('usecases')" class="bg-[#8B5CF6] px-4 py-2 rounded">Start Use Cases →</button>
        </div>
      </div>

      <!-- Inline SVG illustration placeholder (swap with unDraw svg if you want) -->
      <div class="w-full md:w-60 mt-6 md:mt-0">
        <svg viewBox="0 0 200 200" class="w-full h-auto" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="EDR illustration">
          <rect x="10" y="20" width="180" height="120" rx="12" fill="#111827" />
          <rect x="24" y="34" width="70" height="18" rx="4" fill="#8B5CF6" />
          <rect x="24" y="58" width="80" height="8" rx="3" fill="#2f2e41" />
          <circle cx="150" cy="70" r="28" fill="#0EA5A4"/>
          <text x="150" y="76" text-anchor="middle" font-size="20" fill="#fff">EDR</text>
        </svg>
      </div>
    </div>
  </section>

  <!-- Use Cases -->
  <section x-show="active==='usecases'" x-cloak class="card p-6 rounded-lg space-y-6">
    <h2 class="text-2xl font-semibold text-[#BCA6FF]">Use Cases — pick an action and see the lesson</h2>

    <!-- one use case block template -->
    <template x-for="(uc, idx) in usecases" :key="idx">
      <article class="p-4 rounded border border-gray-700">
        <div class="md:flex gap-4 items-start">
          <div class="flex-1">
            <h3 class="font-semibold" x-text="(idx+1)+'. '+uc.title"></h3>
            <p class="text-sm text-gray-300 mt-1" x-text="uc.summary"></p>

            <div class="mt-3 grid grid-cols-1 md:grid-cols-3 gap-2">
              <button @click="takeAction(idx,'investigate')" class="px-3 py-2 rounded bg-amber-600 text-black">Investigate</button>
              <button @click="takeAction(idx,'contain')" class="px-3 py-2 rounded bg-red-600">Contain</button>
              <button @click="takeAction(idx,'monitor')" class="px-3 py-2 rounded bg-green-600">Monitor</button>
            </div>

            <div class="mt-3" x-html="uc.outcome"></div>
          </div>

          <!-- small SVG per usecase -->
          <div class="w-44 mt-4 md:mt-0">
            <!-- simple svg icon, can be replaced with inline unDraw svg -->
            <svg viewBox="0 0 120 80" class="w-full h-auto" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <rect x="6" y="6" width="108" height="68" rx="8" fill="#0A0125" stroke="#8B5CF6" stroke-width="3"/>
              <circle cx="28" cy="38" r="10" fill="#8B5CF6"/>
              <rect x="52" y="30" width="56" height="4" rx="2" fill="#E5E7EB"/>
            </svg>
          </div>
        </div>
      </article>
    </template>

    <div class="flex justify-end gap-3">
      <button @click="complete('usecases'); go('telemetry')" class="bg-[#8B5CF6] px-4 py-2 rounded">Next: Telemetry Lab →</button>
    </div>
  </section>

  <!-- Telemetry Lab -->
  <section x-show="active==='telemetry'" x-cloak class="card p-6 rounded-lg">
    <h2 class="text-2xl font-semibold text-[#BCA6FF]">Telemetry Lab — inspect events</h2>
    <p class="text-sm text-gray-300 mt-2">Click a log line to expand details and classify it. Use filters to focus on type of event.</p>

    <div class="md:flex gap-6 mt-4">
      <!-- left: controls / filters -->
      <div class="md:w-1/3 space-y-3">
        <div class="p-3 rounded border border-gray-700">
          <div class="text-xs text-gray-400">Filters</div>
          <div class="mt-2 flex gap-2 flex-wrap">
            <button @click="filter='all'" :class="filter==='all' ? 'bg-[#8B5CF6]' : 'bg-gray-700'" class="px-2 py-1 rounded text-sm">All</button>
            <button @click="filter='process'" :class="filter==='process' ? 'bg-[#8B5CF6]' : 'bg-gray-700'" class="px-2 py-1 rounded text-sm">Process</button>
            <button @click="filter='network'" :class="filter==='network' ? 'bg-[#8B5CF6]' : 'bg-gray-700'" class="px-2 py-1 rounded text-sm">Network</button>
            <button @click="filter='file'" :class="filter==='file' ? 'bg-[#8B5CF6]' : 'bg-gray-700'" class="px-2 py-1 rounded text-sm">File</button>
          </div>
        </div>

        <div class="p-3 rounded border border-gray-700">
          <div class="text-xs text-gray-400">Classification</div>
          <div class="mt-2">
            <label class="flex items-center gap-2 text-sm">
              <input type="radio" name="classify" value="benign" x-model="classification"> <span>Benign</span>
            </label>
            <label class="flex items-center gap-2 text-sm mt-1">
              <input type="radio" name="classify" value="suspicious" x-model="classification"> <span>Suspicious</span>
            </label>
            <label class="flex items-center gap-2 text-sm mt-1">
              <input type="radio" name="classify" value="malicious" x-model="classification"> <span>Malicious</span>
            </label>

            <div class="mt-3">
              <button @click="applyClassification()" class="bg-[#8B5CF6] px-3 py-1 rounded text-sm">Apply to selected</button>
              <button @click="clearSelection()" class="ml-2 bg-gray-700 px-3 py-1 rounded text-sm">Clear</button>
            </div>
          </div>
        </div>

        <div class="p-3 rounded border border-gray-700">
          <div class="text-xs text-gray-400">Selected event</div>
          <div class="mt-2 p-2 bg-gray-900 rounded mono" x-html="selectedDetails || 'None selected'"></div>
        </div>
      </div>

      <!-- right: logs -->
      <div class="md:flex-1">
        <div class="p-3 rounded border border-gray-700 bg-gray-900 max-h-72 overflow-auto no-scrollbar">
          <template x-for="(ev, i) in filteredEvents" :key="i">
            <div class="p-2 rounded group hover:bg-gray-800 flex justify-between items-start gap-3">
              <div>
                <div class="text-sm"><strong x-text="ev.summary"></strong></div>
                <div class="text-xs text-gray-400 mono" x-text="ev.time"></div>
              </div>
              <div class="flex items-center gap-2">
                <div x-show="ev.class" x-text="ev.class" class="text-xs px-2 py-1 rounded text-black" :class="ev.class==='malicious' ? 'bg-red-400' : (ev.class==='suspicious' ? 'bg-yellow-300':'bg-green-300')"></div>
                <button @click="selectEvent(i)" class="text-xs bg-gray-700 px-2 py-1 rounded">Inspect</button>
              </div>
            </div>
          </template>
        </div>

        <div class="mt-3 flex justify-between">
          <div class="text-xs text-gray-400">Tip: Click an event to view evidence (process, cmdline, network).</div>
          <div>
            <button @click="complete('telemetry'); go('process')" class="bg-[#8B5CF6] px-3 py-1 rounded text-sm">Next: Process Tree →</button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Process Tree -->
  <section x-show="active==='process'" x-cloak class="card p-6 rounded-lg">
    <h2 class="text-2xl font-semibold text-[#BCA6FF]">Process Tree Visualizer</h2>
    <p class="text-sm text-gray-300 mt-2">Click nodes to inspect the process cmdline, parent/children relationships, and indicators.</p>

    <div class="md:flex gap-6 mt-4">
      <div class="md:w-2/3 p-4 rounded border border-gray-700 bg-gray-900">
        <!-- simple visual process tree using SVG -->
        <svg viewBox="0 0 900 240" class="w-full h-56">
          <!-- root -->
          <g transform="translate(450,30)">
            <g class="node" @click.prevent="inspectProcess('proc_root')">
              <rect x="-90" y="0" width="180" height="36" rx="6" fill="#8B5CF6"></rect>
              <text x="0" y="22" text-anchor="middle" fill="#fff" font-size="14">explorer.exe</text>
            </g>

            <!-- children level -->
            <g transform="translate(-220,80)">
              <g class="node" @click.prevent="inspectProcess('proc_powershell')">
                <rect x="-80" y="0" width="160" height="34" rx="6" fill="#111827"></rect>
                <text x="0" y="21" text-anchor="middle" fill="#E5E7EB" font-size="12">powershell.exe</text>
              </g>
            </g>

            <g transform="translate(0,80)">
              <g class="node" @click.prevent="inspectProcess('proc_child')">
                <rect x="-90" y="0" width="180" height="34" rx="6" fill="#111827"></rect>
                <text x="0" y="21" text-anchor="middle" fill="#E5E7EB" font-size="12">wmic.exe</text>
              </g>
            </g>

            <g transform="translate(220,80)">
              <g class="node" @click.prevent="inspectProcess('proc_rdp')">
                <rect x="-70" y="0" width="140" height="34" rx="6" fill="#111827"></rect>
                <text x="0" y="21" text-anchor="middle" fill="#E5E7EB" font-size="12">rdp-invoker.exe</text>
              </g>
            </g>

            <!-- connecting lines -->
            <line x1="0" y1="36" x2="-140" y2="80" stroke="#6b7280" stroke-width="1"/>
            <line x1="0" y1="36" x2="0" y2="80" stroke="#6b7280" stroke-width="1"/>
            <line x1="0" y1="36" x2="140" y2="80" stroke="#6b7280" stroke-width="1"/>
          </g>
        </svg>
      </div>

      <div class="md:w-1/3 space-y-3">
        <div class="p-3 rounded border border-gray-700">
          <div class="text-xs text-gray-400">Process details</div>
          <div class="mt-2 p-2 bg-gray-900 rounded mono" x-html="procDetails || 'Click a node to inspect'"></div>
        </div>

        <div class="p-3 rounded border border-gray-700">
          <div class="text-xs text-gray-400">Actions</div>
          <div class="mt-2 flex gap-2">
            <button @click="isolateEndpoint()" class="bg-red-600 px-3 py-1 rounded text-sm">Isolate endpoint</button>
            <button @click="captureImage()" class="bg-amber-600 px-3 py-1 rounded text-sm text-black">Collect forensic image</button>
            <button @click="complete('process'); go('defense')" class="bg-[#8B5CF6] px-3 py-1 rounded text-sm">Next: Defences →</button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Defences / checklist -->
  <section x-show="active==='defense'" x-cloak class="card p-6 rounded-lg">
    <h2 class="text-2xl font-semibold text-[#BCA6FF]">Best Practices — Interactive Checklist</h2>
    <p class="text-sm text-gray-300 mt-2">Select the controls your organization currently enforces.</p>

    <div class="grid md:grid-cols-2 gap-3 mt-4">
      <label class="p-3 rounded border border-gray-700 flex items-center gap-3">
        <input type="checkbox" x-model="checklist.baseline"> Baseline endpoint behavior baselining
      </label>
      <label class="p-3 rounded border border-gray-700 flex items-center gap-3">
        <input type="checkbox" x-model="checklist.triage"> Alert triage & prioritization
      </label>
      <label class="p-3 rounded border border-gray-700 flex items-center gap-3">
        <input type="checkbox" x-model="checklist.correlation"> Telemetry correlation with SIEM
      </label>
      <label class="p-3 rounded border border-gray-700 flex items-center gap-3">
        <input type="checkbox" x-model="checklist.playbooks"> Incident response playbooks
      </label>
      <label class="p-3 rounded border border-gray-700 flex items-center gap-3">
        <input type="checkbox" x-model="checklist.isolation"> Endpoint isolation capability
      </label>
      <label class="p-3 rounded border border-gray-700 flex items-center gap-3">
        <input type="checkbox" x-model="checklist.tuning"> Detection rule tuning (reduce false positives)
      </label>
    </div>

    <div class="mt-4">
      <button @click="analyzeGaps" class="bg-[#8B5CF6] px-4 py-2 rounded">Analyze Gaps</button>
      <button @click="complete('defense'); go('takeaway')" class="ml-2 bg-gray-700 px-4 py-2 rounded">Finish → Takeaway</button>
    </div>

    <div class="mt-4" x-html="gapResult"></div>
  </section>

  <!-- Takeaway -->
  <section x-show="active==='takeaway'" x-cloak class="card p-6 rounded-lg">
    <h2 class="text-2xl font-semibold text-[#BCA6FF]">Takeaway</h2>
    <p class="text-gray-300 mt-3">EDR telemetry offers visibility into attacker activity. Prioritize high-severity alerts (credential dumping, lateral movement), correlate telemetry with logs, and follow playbooks to isolate and remediate quickly.</p>

    <div class="mt-4 flex gap-3">
      <button @click="restart()" class="bg-[#8B5CF6] px-4 py-2 rounded">Quiz</button>      
    </div>
  </section>
  
</div>

<script>
function edrModule(){
  return {
    active: 'intro',
    sections: ['intro','usecases','telemetry','process','defense','takeaway'],
    completed: {},
    usecases: [
      { title: 'Suspicious PowerShell Activity', summary: 'EDR flags PowerShell with encoded parameters; common ransomware staging tactic.', outcome: '' },
      { title: 'Unauthorized Lateral Movement', summary: 'Workstation initiating multiple RDP sessions after hours.', outcome: '' },
      { title: 'Malicious File Execution', summary: 'File named invoice.pdf.exe executed and beacons to known C2.', outcome: '' },
      { title: 'Credential Dumping', summary: 'Process accessing lsass memory (possible credential dumping).', outcome: '' },
      { title: 'Benign vs False Positive', summary: 'IT runs PsExec during maintenance and EDR flags it.', outcome: '' }
    ],
    // telemetry events sample
    events: [
      { summary: 'Powershell -EncodedCommand launched', time: '2025-09-01 02:12:08', type: 'process', evidence: 'cmdline: powershell -EncodedCommand ...', class: '' },
      { summary: 'Outbound to suspicious IP 45.77.23.10:443', time: '2025-09-01 02:15:22', type: 'network', evidence: 'conn: 45.77.23.10:443 (known C2)', class: '' },
      { summary: 'File executed: invoice.pdf.exe', time: '2025-09-01 02:12:45', type: 'file', evidence: 'file path: C:\\Users\\Public\\invoice.pdf.exe', class: '' },
      { summary: 'LSASS memory read by rundll32.exe', time: '2025-09-01 02:16:03', type: 'process', evidence: 'suspicious handle to lsass', class: '' },
      { summary: 'PsExec invoked for patching window', time: '2025-09-01 03:00:00', type: 'process', evidence: 'psExec used by admin (maintenance)', class: '' }
    ],
    filter: 'all',
    selectedIndex: null,
    selectedDetails: '',
    classification: 'suspicious',
    procDetails: '',
    checklist: { baseline:false, triage:false, correlation:false, playbooks:false, isolation:false, tuning:false },
    gapResult: '',
    init(){
      // restore progress
      this.sections.forEach(s => { this.completed[s] = localStorage.getItem('done_'+s) === '1' });
      this.active = localStorage.getItem('lastSection') || 'intro';
      // restore events classification if present
      try {
        const stored = JSON.parse(localStorage.getItem('edr_events'));
        if(stored && Array.isArray(stored)) this.events = stored;
      } catch(e){}
    },
    go(id){
      this.active = id;
      localStorage.setItem('lastSection', id);
    },
    complete(name){
      this.completed[name] = true;
      localStorage.setItem('done_'+name,'1');
    },
    takeAction(idx, action){
      const uc = this.usecases[idx];
      if(action === 'investigate'){
        uc.outcome = `<div class="p-3 rounded bg-gray-900 border border-amber-600 text-amber-200">You investigated: collected process cmdline and network context. Lesson: gather telemetry before containment.</div>`;
        this.complete('usecases');
      } else if(action === 'contain'){
        uc.outcome = `<div class="p-3 rounded bg-gray-900 border border-red-600 text-red-200">You contained the host immediately. Lesson: containment reduces lateral spread but may slow investigations.</div>`;
        this.complete('usecases');
      } else {
        uc.outcome = `<div class="p-3 rounded bg-gray-900 border border-green-600 text-green-200">You monitored the alert and enriched with telemetry. Lesson: monitoring is OK for low-confidence alerts but escalate if evidence grows.</div>`;
      }
      // persist outcomes (optional)
      localStorage.setItem('edr_usecases', JSON.stringify(this.usecases));
    },
    get filteredEvents(){
      if(this.filter === 'all') return this.events;
      return this.events.filter(e => e.type === this.filter);
    },
    selectEvent(i){
      this.selectedIndex = i;
      const ev = this.filteredEvents[i];
      // show evidence details
      this.selectedDetails = `<strong>${ev.summary}</strong><br/><div class="mt-2 mono">${ev.time}<br/>Type: ${ev.type}<br/>Evidence: ${ev.evidence}</div>`;
    },
    applyClassification(){
      if(this.selectedIndex === null){
        alert('Select an event by clicking "Inspect" first.');
        return;
      }
      // find actual index in events
      const ev = this.filteredEvents[this.selectedIndex];
      // find index in original events array
      const globalIdx = this.events.findIndex(e => e.time === ev.time && e.summary === ev.summary);
      if(globalIdx >= 0){
        this.events[globalIdx].class = this.classification;
        localStorage.setItem('edr_events', JSON.stringify(this.events));
        // update selection display
        this.selectedDetails += `<div class="mt-2 text-sm text-gray-300">Classified as: <strong>${this.classification}</strong></div>`;
      }
    },
    clearSelection(){
      this.selectedIndex = null;
      this.selectedDetails = '';
      this.classification = 'suspicious';
    },
    inspectProcess(which){
      if(which === 'proc_root'){
        this.procDetails = `<strong>explorer.exe</strong><br/>PID: 2484<br/>Cmdline: "C:\\Windows\\explorer.exe"<br/>Notes: parent of suspicious processes.`;
      } else if(which === 'proc_powershell'){
        this.procDetails = `<strong>powershell.exe</strong><br/>PID: 9428<br/>Cmdline: powershell -EncodedCommand ...<br/>Indicators: Base64-encoded command, spawns child wmic.exe.`;
      } else if(which === 'proc_child'){
        this.procDetails = `<strong>wmic.exe</strong><br/>PID: 9512<br/>Cmdline: wmic process call create ...<br/>Notes: may be used for lateral commands.`;
      } else if(which === 'proc_rdp'){
        this.procDetails = `<strong>rdp-invoker.exe</strong><br/>PID: 10021<br/>Cmdline: rdp -connect server1; multiple sessions after hours.`;
      }
    },
    isolateEndpoint(){
      alert('Endpoint isolated (simulated). Notify IR and collect forensic artifacts.');
      this.procDetails += `<div class="mt-2 text-sm text-green-300">Action: Endpoint isolated (simulated).</div>`;
    },
    captureImage(){
      alert('Forensic image collection started (simulated).');
      this.procDetails += `<div class="mt-2 text-sm text-amber-300">Action: Forensic image requested (simulated).</div>`;
    },
    analyzeGaps(){
      const keys = Object.keys(this.checklist);
      const missing = keys.filter(k => !this.checklist[k]);
      if(missing.length===0){
        this.gapResult = `<div class="p-3 rounded bg-gray-900 border border-green-600 text-green-300">No major gaps identified — good baseline.</div>`;
      } else {
        this.gapResult = `<div class="p-3 rounded bg-gray-900 border border-yellow-600 text-yellow-300">Missing controls: ${missing.join(', ')}</div>`;
      }
      localStorage.setItem('edr_checklist', JSON.stringify(this.checklist));
    },
    restart(){
      // this.sections.forEach(s => { localStorage.removeItem('done_'+s); this.completed[s]=false;});
      // localStorage.removeItem('lastSection');
      // this.checklist = { baseline:false, triage:false, correlation:false, playbooks:false, isolation:false, tuning:false };
      // this.gapResult = '';
      // this.go('intro');
      window.top.location.href = "https://lms.collaboratoor.com/student/my-course/endpoint-detection-response-edr-alerts?lecture_uuid=39341da2-0a95-4054-b88e-18793b483016#Quiz";
    }
  }
}
</script>

</body>
</html>
